<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Shop &mdash; Free Website Template, Free HTML5 Template by gettemplates.co</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Free HTML5 Website Template by gettemplates.co" />
    <meta name="keywords" content="free website templates, free html5, free template, free bootstrap, free website template, html5, css3, mobile first, responsive" />
    <meta name="author" content="gettemplates.co" />

    <!-- Animate.css -->
    <link rel="stylesheet" th:href="@{/css/animate.css}">
    <!-- Icomoon Icon Fonts-->
    <link rel="stylesheet" th:href="@{/css/icomoon.css}">
    <!-- Bootstrap  -->
    <link rel="stylesheet" th:href="@{/css/bootstrap.css}">

    <!-- Flexslider  -->
    <link rel="stylesheet" th:href="@{/css/flexslider.css}">

    <!-- Owl Carousel  -->
    <link rel="stylesheet" th:href="@{/css/owl.carousel.min.css}">
    <link rel="stylesheet" th:href="@{/css/owl.theme.default.min.css}">

    <!-- Theme style  -->
    <link rel="stylesheet" th:href="@{/css/style.css}">

    <!-- Modernizr JS -->
    <script th:src="@{/js/modernizr-2.6.2.min.js}"></script>
    <!-- FOR IE9 below -->
    <!--[if lt IE 9]>
    <script th:src="@{/js/respond.min.js}"></script>
    <![endif]-->
    <script th:src="@{/js/modernizr-2.6.2.min.js}"></script>

    <style>

	.star-rating {
    font-size: 30px;
    direction: ltr; /* 왼쪽 정렬 */
}

label {
    color: orange;
    unicode-bidi: bidi-override;
    direction: ltr;
    font-size: 15px;
    text-align: left; /* 왼쪽 정렬 */
}



    </style>
</head>


<body>

<div class="fh5co-loader"></div>

<div id="page">
    <!--  카테고리  ==============================================================================================-->
    <nav class="fh5co-nav" role="navigation">
        <div class="container">
            <div class="row">
                <div class="col-md-3 col-xs-2">
                    <div id="fh5co-logo"><a href="/">Bang & Oops</a></div>
                </div>
                <div class="col-md-6 col-xs-6 text-center menu-1">
                    <ul>
                        <li><a href="/product/productList?categoryNumber=1">SPEAKER</a></li>
                        <li><a href="/product/productList?categoryNumber=2">EARPHONE</a></li>
                        <li><a href="/product/productList?categoryNumber=3">HEADPHONE</a></li>
                        <li><a href="/product/productList?categoryNumber=4">ACCESSORIES</a></li>
                        <li class="has-dropdown">
                            <a href="">COMMUNITY</a>
                            <ul class="dropdown">
                                <li><a href="/notice/noticeList">공지사항</a></li>
                                <li><a href="/review/reviewList">REVIEW</a></li>
                                <li><a href="/qna/qnaList">Q&A</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
                <div class="col-md-3 col-xs-4 text-right hidden-xs menu-2">
                    <ul>
                        <li class="shopping-cart menu-2"><a href="/product/cart" class="cart"><span><small
                                th:text="${cartListCount}">0</small><i
                                class="icon-shopping-cart"></i></span></a></li>
                        <li class="login menu-2" th:text="${username}" id="username"></li>
                        <!-- 로그인 상태일 때 -->
                        <li class="login menu-2" sec:authorize="isAuthenticated()" id="mypage">
                            님 <a href="/mypage">mypage</a>
                        </li>
                        <li class="login menu-2" sec:authorize="isAuthenticated()" id="logout">
                            <a href="/logout">logout</a>
                        </li>

                        <!-- 로그인 상태가 아닐 때 -->
                        <li class="login menu-2" sec:authorize="isAnonymous()" id="join">
                            <a href="/join">JOIN</a>
                        </li>
                        <li class="login menu-2" sec:authorize="isAnonymous()" id="login">
                            <a href="/login">login</a>
                        </li>

                    </ul>
                </div>
            </div>
        </div>
    </nav>

<!--    ==============================================================================================-->
    <header id="fh5co-header" class="fh5co-cover fh5co-cover-sm" role="banner" style="background-image:url(/images/category_img2.jpg); background-position: bottom center;">
        <div class="overlay"></div>
        <div class="container">
            <div class="row">
                <div class="col-md-8 col-md-offset-2 text-center">
                    <div class="display-t">
                        <div class="display-tc animate-box" data-animate-effect="fadeIn">
                            <h1>REVIEW</h1>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

<!--    =============================================================================================-->
    <div id="fh5co-services" class="">
        <div class="container">
            <div class="col-md-12 animate-box fadeInUp animated-fast">
            <div class="row" >
                <div><h2>REVIEW</h2></div>
                <br><br>

                <div>
                    <a th:href="@{/review/reviewDelete(replyNumber=${reviewDTO.replyNumber})}"><input type="button" class="btn btn-primary btn-outline" style="font-size: 14px; float:right;" value="삭제" /></a>
                    <a th:href="@{/review/reviewModify(replyNumber=${reviewDTO.replyNumber})}"><input type="button" class="btn btn-primary" style="font-size: 14px;float:right;" value="수정" /></a>
                    <a th:href="@{/review/reviewList}"><input type="button" class="btn btn-primary" style="font-size: 14px;float:right;" value="목록" /></a>
                </div>

                    <table class="table">
                        <tr>
                            <th>게시물번호</th>
                            <td th:text="${reviewDTO.replyRef}"></td>
                            <th>작성자</th>
                            <td th:text="${reviewDTO.replyWriter}"></td>
                        </tr>
                        <tr>
                            <th>작성일</th>
                            <td th:text="${reviewDTO.replyDate}"></td>
                            <th>리뷰점수</th>

                                <td>
                            <label th:each="score : ${#numbers.sequence(1, reviewDTO.replyScore)}" for="star" >&#9733;</label>
                                </td>
                        </tr>
                        <tr>
                            <th>내용</th>
                            <td colspan="4" th:utext="${reviewDTO.replyContents}"></td>

                        </tr>
                    </table>



                <!--================================================================================================-->
                <!--                댓글 작성폼-->
                <br><br><br><br><br><br><br><br>
                <hr style="border:1px solid #EEEEEE">
                <strong style="margin-left:10px">댓글</strong> <br><br>

                <div style="text-align: left;">
                    <input type="hidden" id="replyWriter" th:value="${username}"
                           style="width: 100px; height: 40px; text-align: center; font-size: 14px;  border: 2px solid #E4E4E4; border-radius: 5px; vertical-align: top; margin-left:10px">
                    <input type="text" id="replyContents" placeholder="댓글을 입력해주세요."
                           style="width: 920px; height: 40px; text-align: center; font-size: 14px; border: 2px solid #E4E4E4; border-radius: 5px; vertical-align: top;margin-left:10px ;">
                    <button id="comment-write-btn" th:onclick="commentWrite()" class="btn btn-primary"
                            style="font-size: 12px; vertical-align: top; margin-left:20px">등록</button>
                    <input type="hidden" id="productName" th:value="#{reviewDTO.productName}">
                    <input type="hidden" id="productNumber" th:value="#{reviewDTO.productNumber}">
               </div>

                <br> <br>
            </div>
            </div>
                <hr>
<!--        ======================================================================================-->
            <div id="comment-list" style="text-align: left;">
                <table class="table table-striped">

                    <div class="col-md-12 animate-box fadeInUp animated-fast" th:each="reviewDTO2 : ${list}"
                    style="">

                        <div class="col-md-1" id="comment-writer" th:text="${reviewDTO2.replyWriter}"></div>
                        <div class="col-md-2" id="comment-date" th:text="${reviewDTO2.replyDate}" style="color:#D2D2D2" ></div>
                        <div  id="comment-contents" th:text="${reviewDTO2.replyContents}"></div>
                        <hr>

<!--                        테이블-->
<!--                        <td id="comment-contents" th:text="${reviewDTO2.replyContents}" ></td>-->
<!--                        <td id="comment-writer" th:text="${reviewDTO2.replyWriter}" ></td>-->
<!--                        <td id="comment-date" th:text="${reviewDTO2.replyDate}" ></td>-->

<!--                        기존-->
<!--                        <td id="comment-contents" th:text="${reviewDTO2.replyContents}" style="width: 800px; height: 38px; text-align: center; font-size: 14px; border: 2px solid #D1C286; padding: 10px;border-right: none;"></td>-->
<!--                        <td id="comment-writer" th:text="${reviewDTO2.replyWriter}" style="width: 90px; height: 38px; text-align: center; font-size: 14px; border: 2px solid #D1C286; padding: 10px;border-left: none; border-right: none;"></td>-->
<!--                        <td id="comment-date" th:text="${reviewDTO2.replyDate}" style="width: 90px; height: 38px; text-align: center; font-size: 14px; border: 2px solid #D1C286; padding: 10px;border-left: none;"></td>-->
<!--                    -->
                    </div>
                </table>
            </div>

        </div>
        </div>
    </div>




<footer id="fh5co-footer" role="contentinfo" style="background: #D1C286">
    <div class="container">
        <div class="row copyright">
            <div class="col-md-12 text-center">
                <p>
                    <small class="block">&copy; 2023 Free HTML5. All Rights Reserved.</small>
                    <small class="block">Designed by <a href="http://freehtml5.co/" target="_blank"
                                                        style="color:white">FreeHTML5.co</a>
                        Demo Images: <a href="http://blog.gessato.com/"
                                        target="_blank" style="color:white">Gessato</a> &amp; <a
                                href="http://unsplash.co/"
                                target="_blank" style="color:white">Unsplash</a></small>
                </p>
            </div>
        </div>
    </div>
</footer>
</div>

<div class="gototop js-top">
    <a th:href="@{#}" class="js-gotop"><i class="icon-arrow-up"></i></a>
</div>

<!-- jQuery -->
<script th:src="@{/js/jquery.min.js}"></script>
<!-- jQuery Easing -->
<script th:src="@{/js/jquery.easing.1.3.js}"></script>
<!-- Bootstrap -->
<script th:src="@{/js/bootstrap.min.js}"></script>
<!-- Waypoints -->
<script th:src="@{/js/jquery.waypoints.min.js}"></script>
<!-- Carousel -->
<script th:src="@{/js/owl.carousel.min.js}"></script>
<!-- countTo -->
<script th:src="@{/js/jquery.countTo.js}"></script>
<!-- Flexslider -->
<script th:src="@{/js/jquery.flexslider-min.js}"></script>
<!-- Main -->
<script th:src="@{/js/main.js}"></script>

</body>

<script th:inline="javascript">


// commentWrite 함수 정의
const commentWrite = () => {
    const writer = document.getElementById("replyWriter").value;
    const contents = document.getElementById("replyContents").value;
    const number = /*[[${reviewDTO.replyNumber}]]*/;
    const ref = /*[[${reviewDTO.replyRef}]]*/;
    const pNumber = /*[[${reviewDTO.productNumber}]]*/;
    const ParentNumber = /*[[${reviewDTO.replyParentNumber}]]*/;
    const productName = document.getElementById("productName").value;

    $.ajax({
        type: "post",
        url: "/review/reviewDetail",
        data: {
            replyWriter: writer,
            replyContents: contents,
            replyNumber: number,
            replyRef: ref,
            replyParentNumber: ParentNumber,
            member_id : writer,
            productName : productName,
            productNumber : pNumber
        },
        dataType: "json",
        success: function(commentList) {
            console.log("작성성공");
            console.log(commentList);
             let output = "";

            for (let i in commentList) {
                output += '<div class="col-md-12 animate-box fadeInUp animated-fast">';
                output += '<div class="col-md-1" id="comment-writer">' + commentList[i].replyWriter + '</div>';
                output += '<div class="col-md-2" id="comment-date" style="color:#D2D2D2">' + commentList[i].replyDate + '</div>';
                output += '<div id="comment-contents">' + commentList[i].replyContents + '</div>';
                output += '<hr>';
                output += '</div>';
            }

            document.getElementById('comment-list').innerHTML = output;
            document.getElementById('replyWriter').value = ''; // 입력 필드 초기화
            document.getElementById('replyContents').value = ''; // 입력 필드 초기화
        },
        error: function() {
            console.log("실패");
        }
    });
};
</script>

</html>
